
<VirtualHost *:80>

  ServerName rs.tdwg.org:80
  DocumentRoot /var/www/html/rs.tdwg.org/rs/public

  ErrorLog logs/rs.tdwg.org-error_log
  TransferLog logs/rs.tdwg.org-access_log
  LogLevel warn

  DirectoryIndex index.html index.htm rddl.html

  # Rewrite engine setup
  RewriteEngine On
  RewriteLog "/etc/httpd/logs/rewrite_log"
  RewriteLogLevel 0

  <Directory /var/www/html/rs.tdwg.org/rs/public>
    AllowOverride None
  </Directory>

  <Location />
    Options +Indexes
  </Location>

  <Files ~ "^.svn">
    Order allow,deny
    Deny from all
    Satisfy All
  </Files>



### TAPIR ###
  RewriteRule http://rs.tdwg.org/tapir/cns/(.*)$ http://tdwg.github.io/tapir/cns/$1 [NE,L,R]
  RewriteRule http://rs.tdwg.org/tapir/cs/(.*)$ http://tdwg.github.io/tapir/cs/$1 [NE,L,R]
  RewriteRule http://rs.tdwg.org/tapir/1.0/schema/tdwg_tapir.xsd$ https://raw.githubusercontent.com/tdwg/tapir/1.0/schema/tapir.xsd [NE,L,P]
  RewriteRule http://rs.tdwg.org/tapir/1.0/(.+)$ https://raw.githubusercontent.com/tdwg/tapir/1.0/$1 [NE,L,P]
  RewriteRule http://rs.tdwg.org/tapir/([^\d]+)$ https://raw.githubusercontent.com/tdwg/tapir/$1 [NE,L,P]



### ONTOLOGY ###
  ProxyPass /ontology2 http://tdwg-ontology.googlecode.com/svn/trunk/ontology/
  RewriteRule ^/ontology/.*\/$ - [L]
  #RewriteCond {REQUEST_FILENAME} !-d
  RewriteRule ^/ontology/([^\.]*[^.])$ /ontology/$1.rdf

  <Location /ontology>
    # Directive to ensure *.rdf files served as appropriate content type,
    # if not present in main apache config
    #AddType application/rdf+xml .rdf
    AddType text/xml .rdf
  </Location>



### DWC ###

  # Content Negotiation defaults to html if rdf/xml is not requested

  # dwc attributes
  RewriteCond %{HTTP_ACCEPT} application/rdf\+xml
  RewriteRule ^/dwc/terms/attributes/(.*)$ http://tdwg.github.io/dwc/terms/attributes/dwcattributes.rdf [R=303]
  RewriteRule ^/dwc/terms/attributes/(.*)$ http://tdwg.github.io/dwc/terms/attributes/dwcattributes.rdf#$1 [NE,R=303] #NE,R,L,P]

  # dwc terms
  RewriteCond %{HTTP_ACCEPT} application/rdf\+xml
  RewriteRule ^/dwc/terms/([a-zA-Z0-9-]*)$ http://tdwg.github.io/dwc/rdf/dwcterms.rdf [R=303]
  RewriteRule ^/dwc/terms/([a-zA-Z0-9-]+)$ http://tdwg.github.io/dwc/terms/index.htm#$1 [NE,R=303] #NE,R,L,P]

  # proxy all other /dwc URLs from github pages:
  RewriteRule ^/dwc$ /dwc/ [R=301,L]
  RewriteRule ^/dwc/$     http://tdwg.github.io/dwc/index.htm [NE,L,P]
  RewriteRule ^/dwc/(.+)/$ http://tdwg.github.io/dwc/$1/index.htm [NE,L,P]
  RewriteRule ^/dwc/(.+)$  http://tdwg.github.io/dwc/$1 [NE,L,P]


  <Location /dwc>
    # Directive to ensure *.rdf files served as appropriate content type,
    # if not present in main apache config
    AddType application/rdf+xml .rdf
    AddType text/xml .xml
    AddType text/xml .xsd
    AddType text/html .html
    AddType text/html .htm
    AddType text/plain .txt
 </Location>



### AudubonCore ###
  # Resolution of ac term URIs
  RewriteRule ^/ac/terms/([^/]+)$ http://terms.tdwg.org/wiki/Audubon_Core_Term_List#ac:$1 [NE,R=303] #NE,R,L,P]

  <Location /ac>
    # Directive to ensure *.rdf files served as appropriate content type,
    # if not present in main apache config
    AddType application/rdf+xml .rdf
    AddType text/xml .xml
    AddType text/xml .xsd
    AddType text/html .html
    AddType text/html .htm
    AddType text/plain .txt
 </Location>
 
</VirtualHost>
